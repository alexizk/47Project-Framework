{
  "schemaVersion": 1,
  "moduleId": "AppSCrawler",
  "displayName": "AppS Crawler",
  "version": "1.0.0",
  "minFrameworkVersion": "1.0.0",
  "publisher": "47Project",
  "description": "Install/update/uninstall apps via providers (winget/choco/msi/msix/portable).",
  "category": "System",
  "tags": [
    "apps",
    "winget",
    "choco",
    "msi",
    "msix",
    "portable"
  ],
  "ui": {
    "icon": "assets/icon.png",
    "defaultRoute": "/apps/overview",
    "allowPopOut": true,
    "navigation": [
      {
        "id": "overview",
        "title": "Overview",
        "route": "/apps/overview"
      },
      {
        "id": "catalog",
        "title": "Catalogs & Profiles",
        "route": "/apps/catalog"
      },
      {
        "id": "providers",
        "title": "Providers",
        "route": "/apps/providers"
      },
      {
        "id": "plans",
        "title": "Plans",
        "route": "/apps/plans"
      },
      {
        "id": "runs",
        "title": "Run History",
        "route": "/apps/runs"
      },
      {
        "id": "settings",
        "title": "Settings",
        "route": "/apps/settings"
      }
    ]
  },
  "settings": {
    "rootKey": "Framework.Modules.AppSCrawler",
    "storageScopes": {
      "policy": [
        "risk.*",
        "approval.*",
        "allowlist.*",
        "denylist.*",
        "trust.*"
      ],
      "machine": [
        "downloads.*",
        "cache.*",
        "inventory.*",
        "scheduler.*",
        "providers.*"
      ],
      "user": [
        "ui.*",
        "defaults.*",
        "experiments.*"
      ]
    },
    "pages": [
      {
        "id": "apps.settings",
        "title": "AppSCrawler Settings",
        "route": "/apps/settings",
        "groups": [
          {
            "id": "risk",
            "title": "Risk & Safety",
            "controls": [
              {
                "key": "risk.allowUnsafe",
                "type": "toggle",
                "title": "Allow unsafe actions",
                "description": "Enables Unsafe steps (registry uninstall, custom hooks).",
                "default": false,
                "risk": "Unsafe",
                "requiresCapability": "cap.software.registry_uninstall_unsafe"
              },
              {
                "key": "approval.require",
                "type": "toggle",
                "title": "Require plan approval",
                "default": false,
                "risk": "Caution"
              },
              {
                "key": "approval.allowBypass",
                "type": "toggle",
                "title": "Allow UI bypass of approval (unsafe)",
                "default": true,
                "risk": "Unsafe",
                "visibleWhen": "policy.approval.require == true"
              }
            ]
          },
          {
            "id": "downloads",
            "title": "Downloads & Cache",
            "controls": [
              {
                "key": "downloads.dir",
                "type": "path",
                "title": "Downloads directory",
                "default": "%ProgramData%\\\\Project47\\\\downloads",
                "risk": "Safe"
              },
              {
                "key": "cache.contentAddressed",
                "type": "toggle",
                "title": "Content-addressed cache (dedupe)",
                "default": false,
                "risk": "Caution"
              },
              {
                "key": "downloads.offlineMode",
                "type": "toggle",
                "title": "Offline mode (cache only)",
                "default": false,
                "risk": "Caution"
              }
            ]
          },
          {
            "id": "providers",
            "title": "Providers",
            "controls": [
              {
                "key": "providers.allowed",
                "type": "multiselect",
                "title": "Allowed providers",
                "default": [
                  "winget",
                  "choco",
                  "msi",
                  "msix",
                  "download",
                  "portable"
                ],
                "risk": "Caution"
              },
              {
                "key": "providers.blocked",
                "type": "multiselect",
                "title": "Blocked providers",
                "default": [],
                "risk": "Caution"
              }
            ]
          },
          {
            "id": "reports",
            "title": "Reports & Logs",
            "controls": [
              {
                "key": "reports.json",
                "type": "toggle",
                "title": "Write JSON report",
                "default": true,
                "risk": "Safe"
              },
              {
                "key": "logs.jsonl",
                "type": "toggle",
                "title": "Write JSONL logs",
                "default": true,
                "risk": "Safe"
              }
            ]
          }
        ]
      }
    ]
  },
  "capabilities": [
    "cap.inventory.read",
    "cap.software.install",
    "cap.software.update",
    "cap.software.uninstall",
    "cap.software.msi",
    "cap.software.msix",
    "cap.download.network",
    "cap.policy.read",
    "cap.logs.write",
    "cap.diagnostics.bundle"
  ],
  "riskProfile": {
    "defaultRiskLevel": "Caution",
    "unsafeRequiresExplicitEnable": true,
    "unsafeUIWarnings": true
  },
  "trust": {
    "signatureRequired": true,
    "contentSignatureRequired": true,
    "publisherThumbprintsAllowlist": [
      "<YOUR_CERT_THUMBPRINT>"
    ]
  },
  "entrypoint": "module.psm1",
  "apiLevel": 1,
  "supportedPlatforms": [
    "win32"
  ],
  "minPowerShellVersion": "7.2"
}