<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Threat_Model.md</title>
<style>
body { font-family: system-ui, Segoe UI, Arial, sans-serif; margin: 2rem; line-height: 1.5; max-width: 1100px; }
pre { white-space: pre-wrap; word-wrap: break-word; background: #f6f8fa; padding: 1rem; border-radius: 12px; }
code { background: #f6f8fa; padding: 0.1rem 0.2rem; border-radius: 6px; }
a { color: #0b57d0; }
table { border-collapse: collapse; }
td, th { border: 1px solid #ddd; padding: 6px 10px; }
</style>
</head>
<body>
<h1>Threat Model (v1)</h1>

<p>This document describes the main threats and mitigations for 47Project Framework.</p>

<h2>Assets</h2>

<ul>
<li>Plan files (<code>*.plan.json</code>)</li>
<li>Offline bundles (<code>*.47bundle</code>)</li>
<li>Module manifests (<code>modules/*/module.json</code>) and module code</li>
<li>Policy (<code>policy.json</code>)</li>
<li>Logs and diagnostics bundles</li>
</ul>

<h2>Threats &amp; mitigations</h2>

<h3>Plan tampering</h3>

<p><strong>Threat:</strong> A plan is modified to install different software or run unsafe steps.<br />
<strong>Mitigations:</strong>
- Canonicalization + SHA-256 hashing (<code>Plan_Canonicalization_Hash_Spec_v1.md</code>)
- Optional embedded signatures (<code>tools/Sign-47Plan.ps1</code>, <code>tools/Verify-47Signature.ps1</code>)
- Policy gating of unsafe actions (<code>examples/policies/*.policy.json</code>)</p>

<h3>Bundle substitution / payload swap</h3>

<p><strong>Threat:</strong> A <code>.47bundle</code> is swapped or payload contents are changed.<br />
<strong>Mitigations:</strong>
- Bundle manifest includes <code>planHash</code>
- <code>tools/Verify-47Bundle.ps1</code> recomputes and checks the plan hash
- (Optional future) content hashing for payload items + manifest signature</p>

<h3>Module spoofing</h3>

<p><strong>Threat:</strong> A malicious module is placed in the <code>modules</code> directory.<br />
<strong>Mitigations:</strong>
- Signed modules (optional; trust model supports allowlists)
- Policy-based capability grants per module
- UI warnings for unsafe modules/steps</p>

<h3>Logging leakage</h3>

<p><strong>Threat:</strong> Sensitive data appears in logs/support bundles.<br />
<strong>Mitigations:</strong>
- Keep logs structured and avoid secrets
- Support bundle exporter is intentionally conservative
- Provide user review before sharing bundles (recommended operational practice)</p>

</body>
</html>
