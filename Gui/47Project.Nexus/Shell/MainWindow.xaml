<Window x:Class="_47Project.Nexus.Shell.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:_47Project.Nexus.ViewModels"
        xmlns:pages="clr-namespace:_47Project.Nexus.Pages"
        xmlns:controls="clr-namespace:_47Project.Nexus.Controls"
        Title="47Project Framework â€” Nexus" Width="1200" Height="760"
        Background="{DynamicResource App.Background}">
  <Window.Resources>
    <DataTemplate DataType="{x:Type vm:DashboardViewModel}">
      <pages:DashboardPage/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:PlanRunViewModel}">
      <pages:PlanRunPage/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:SettingsViewModel}">
      <pages:SettingsPage/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:PlaceholderViewModel}">
      <pages:PlaceholderPage/>
    </DataTemplate>
  </Window.Resources>

  <Grid>
    <DockPanel LastChildFill="True">
      <Border DockPanel.Dock="Left" Width="260" Background="{DynamicResource App.Surface}" BorderBrush="{DynamicResource App.Border}" BorderThickness="0,0,1,0">
        <StackPanel>
          <TextBlock Text="47Project Nexus" FontSize="20" FontWeight="SemiBold" Margin="16,16,16,12" Foreground="{DynamicResource App.Text}"/>
          <ListBox ItemsSource="{Binding NavItems}" SelectedItem="{Binding Selected}" Margin="8" BorderThickness="0" Background="Transparent">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Border CornerRadius="10" Padding="12,10" Margin="0,0,0,6"
                        Background="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Background}"
                        BorderBrush="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=BorderBrush}"
                        BorderThickness="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=BorderThickness}">
                  <TextBlock Text="{Binding Title}" FontSize="14"
                             Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                </Border>
              </DataTemplate>
            </ListBox.ItemTemplate>
            <ListBox.ItemContainerStyle>
              <Style TargetType="ListBoxItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="0"/>
                <Setter Property="Margin" Value="0"/>
                <Setter Property="Foreground" Value="{DynamicResource App.SubtleText}"/>
                <Style.Triggers>
                  <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#1A00FF66"/>
                    <Setter Property="BorderBrush" Value="{DynamicResource App.Accent}"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Foreground" Value="{DynamicResource App.Text}"/>
                  </Trigger>
                </Style.Triggers>
              </Style>
            </ListBox.ItemContainerStyle>
          </ListBox>
        </StackPanel>
      </Border>

      <Grid Margin="14">
        <ContentControl Content="{Binding Current}"/>
      </Grid>
    </DockPanel>

    <!-- Optional visual overlay (toggle in Settings) -->
    <controls:MatrixRainOverlayControl Enabled="{Binding SettingsVm.MatrixRainEnabled}"
                                       Intensity="{Binding SettingsVm.MatrixRainIntensity}"
                                       Opacity="0.35"
                                       />
  </Grid>
</Window>
